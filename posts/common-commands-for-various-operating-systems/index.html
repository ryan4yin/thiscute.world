<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Linux/Windows/MacOSX 系统常用命令集锦 - This Cute World</title><meta name=Description content="This Cute World"><meta property="og:title" content="Linux/Windows/MacOSX 系统常用命令集锦"><meta property="og:description" content="个人笔记，只会列出我自己容易忘掉的命令，方便查阅。 内容比较多，适合当参考手册用。可能不太适合从头读到尾&mldr; 本文主要介绍 Linux 命令，顺"><meta property="og:type" content="article"><meta property="og:url" content="https://thiscute.world/posts/common-commands-for-various-operating-systems/"><meta property="og:image" content="https://thiscute.world/posts/common-commands-for-various-operating-systems/terminal.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-13T16:09:00+08:00"><meta property="article:modified_time" content="2022-02-13T16:09:00+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://thiscute.world/posts/common-commands-for-various-operating-systems/terminal.webp"><meta name=twitter:title content="Linux/Windows/MacOSX 系统常用命令集锦"><meta name=twitter:description content="个人笔记，只会列出我自己容易忘掉的命令，方便查阅。 内容比较多，适合当参考手册用。可能不太适合从头读到尾&mldr; 本文主要介绍 Linux 命令，顺"><meta name=application-name content="This Cute World"><meta name=apple-mobile-web-app-title content="This Cute World"><meta name=theme-color content="#f8f8f8"><meta name=twitter:creator content="@ryan4yin"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=canonical href=https://thiscute.world/posts/common-commands-for-various-operating-systems/><link rel=prev href=https://thiscute.world/posts/python-tips-and-tricks/><link rel=next href=https://thiscute.world/posts/likenttt-2020-12-13-guangzhou-marathon-3_30_15/><link rel=alternate href=/posts/common-commands-for-various-operating-systems/index.xml type=application/rss+xml title="This Cute World"><link rel=feed href=/posts/common-commands-for-various-operating-systems/index.xml type=application/rss+xml title="This Cute World"><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="E8bpp1lVVlb9YnSJcUzPL1dLAG17Nl_sp5Ru9a8tUDQ"><meta name=baidu-site-verification content="code-ZZtDruAnX1"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Linux/Windows/MacOSX 系统常用命令集锦","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https://thiscute.world/posts/common-commands-for-various-operating-systems/"},"image":[{"@type":"ImageObject","url":"https://thiscute.world/posts/common-commands-for-various-operating-systems/terminal.webp","width":1200,"height":553}],"genre":"posts","keywords":"Linux, MacOSX, Windows, CLI, Powershell, Shell, tmux, rsync, vim, awk","wordcount":8324,"url":"https://thiscute.world/posts/common-commands-for-various-operating-systems/","datePublished":"2022-02-13T16:09:00+08:00","dateModified":"2022-02-13T16:09:00+08:00","publisher":{"@type":"Organization","name":"ryan4yin","logo":"https://thiscute.world/avatar/myself.png"},"author":{"@type":"Person","name":"ryan4yin"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="This Cute World"><span id=desktop-header-typeit class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/statistics/>阅读排行 </a><a class=menu-item href=/series/>系列 </a><a class=menu-item href=/categories/tech/>技术 </a><a class=menu-item href=/categories/life/>生活 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/friends/>朋友们 </a><a class=menu-item href=/now/>此刻 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item language" title=选择语言>Simplified Chinese<i class="fas fa-chevron-right fa-fw"></i>
<select class=language-select title=选择语言 id=language-select-desktop onchange="location=this.value"><option value=/posts/common-commands-for-various-operating-systems/ selected>Simplified Chinese</option></select>
</a><span class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="This Cute World"><span id=mobile-header-typeit class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/statistics/ title>阅读排行</a><a class=menu-item href=/series/ title>系列</a><a class=menu-item href=/categories/tech/ title>技术</a><a class=menu-item href=/categories/life/ title>生活</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/friends/ title>朋友们</a><a class=menu-item href=/now/ title>此刻</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i>
</a><a href=javascript:void(0); class=menu-item title=选择语言>Simplified Chinese<i class="fas fa-chevron-right fa-fw"></i>
<select class=language-select title=选择语言 onchange="location=this.value"><option value=/posts/common-commands-for-various-operating-systems/ selected>Simplified Chinese</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#一linux>一、Linux</a><ul><li><a href=#1-后台运行>1. 后台运行</a></li><li><a href=#2-查找替换-sedawk-与-jsonyaml-处理-jqyq>2. 查找替换 sed/awk 与 json/yaml 处理 jq/yq</a></li><li><a href=#3-压缩相关>3. 压缩相关</a></li><li><a href=#4-文件拷贝与同步>4. 文件拷贝与同步</a><ul><li><a href=#1-sshscp>1. ssh/scp</a></li><li><a href=#2-rsync>2. rsync</a></li></ul></li><li><a href=#5-tmux>5. Tmux</a></li><li><a href=#6-bash-shell-基础>6. Bash Shell 基础</a><ul><li><a href=#1-for-循环>1. For 循环</a></li><li><a href=#2-if-语句>2. if 语句</a></li><li><a href=#3-shell-脚本中的-set-指令比如-set--x-和-set--e>3. Shell 脚本中的 set 指令，比如 set -x 和 set -e</a></li><li><a href=#4-实用小工具>4. 实用小工具</a></li><li><a href=#5-查询历史记录>5. 查询历史记录</a></li><li><a href=#6-其他资料>6. 其他资料</a></li></ul></li><li><a href=#socket-commands>7. socket 连接查询 - ss/netcat/lsof</a></li><li><a href=#8-其他网络相关命令>8. 其他网络相关命令</a></li><li><a href=#9-容器网络诊断---nsenter>9. 容器网络诊断 - nsenter</a></li><li><a href=#10-用户与群组>10. 用户与群组</a></li></ul></li><li><a href=#二powershell>二、Powershell</a><ul><li><a href=#1-实用命令>1. 实用命令</a></li><li><a href=#2-进程相关命令>2. 进程相关命令</a></li><li><a href=#3-网络相关命令>3. 网络相关命令</a></li><li><a href=#4-socket-信息查询---netstat>4. socket 信息查询 - netstat</a></li></ul></li><li><a href=#三mac-os-x>三、Mac OS X</a><ul><li><a href=#1-查看-socket-信息>1. 查看 socket 信息</a></li><li><a href=#2-其他网络相关命令>2. 其他网络相关命令</a></li></ul></li><li><a href=#四跨平台程序>四、跨平台程序</a><ul><li><a href=#1-vim>1. vim</a><ul><li><a href=#常用技巧>常用技巧</a></li><li><a href=#多行修改>多行修改</a></li><li><a href=#多行替换基本和-sed-一致>多行替换（基本和 sed 一致）</a></li><li><a href=#将选中部分写入到文件>将选中部分写入到文件</a></li><li><a href=#问题在-vim-中粘贴-yaml-时缩进会变得一团糟>问题：在 vim 中粘贴 yaml 时缩进会变得一团糟</a></li></ul></li></ul></li><li><a href=#参考>参考</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Linux/Windows/MacOSX 系统常用命令集锦</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class="author fas fa-user-circle fa-fw"></span><a href=https://thiscute.world/ title=Author target=_blank rel="noopener noreferrer author" class=author>ryan4yin</a>
</span>&nbsp;<span class=post-category>收录于 </span>&nbsp;<span class=post-category>类别 <a href=/categories/tech/><i class="far fa-folder fa-fw"></i>tech</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2022-02-13>2022-02-13</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2022-02-13>2022-02-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 8324 字&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 17 分钟&nbsp;</div></div><div class=featured-image><img loading=eager src=/posts/common-commands-for-various-operating-systems/terminal.webp srcset="/posts/common-commands-for-various-operating-systems/terminal.webp, /posts/common-commands-for-various-operating-systems/terminal.webp 1.5x, /posts/common-commands-for-various-operating-systems/terminal.webp 2x" sizes=auto alt=/posts/common-commands-for-various-operating-systems/terminal.webp title=/posts/common-commands-for-various-operating-systems/terminal.webp height=553 width=1200></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#一linux>一、Linux</a><ul><li><a href=#1-后台运行>1. 后台运行</a></li><li><a href=#2-查找替换-sedawk-与-jsonyaml-处理-jqyq>2. 查找替换 sed/awk 与 json/yaml 处理 jq/yq</a></li><li><a href=#3-压缩相关>3. 压缩相关</a></li><li><a href=#4-文件拷贝与同步>4. 文件拷贝与同步</a><ul><li><a href=#1-sshscp>1. ssh/scp</a></li><li><a href=#2-rsync>2. rsync</a></li></ul></li><li><a href=#5-tmux>5. Tmux</a></li><li><a href=#6-bash-shell-基础>6. Bash Shell 基础</a><ul><li><a href=#1-for-循环>1. For 循环</a></li><li><a href=#2-if-语句>2. if 语句</a></li><li><a href=#3-shell-脚本中的-set-指令比如-set--x-和-set--e>3. Shell 脚本中的 set 指令，比如 set -x 和 set -e</a></li><li><a href=#4-实用小工具>4. 实用小工具</a></li><li><a href=#5-查询历史记录>5. 查询历史记录</a></li><li><a href=#6-其他资料>6. 其他资料</a></li></ul></li><li><a href=#socket-commands>7. socket 连接查询 - ss/netcat/lsof</a></li><li><a href=#8-其他网络相关命令>8. 其他网络相关命令</a></li><li><a href=#9-容器网络诊断---nsenter>9. 容器网络诊断 - nsenter</a></li><li><a href=#10-用户与群组>10. 用户与群组</a></li></ul></li><li><a href=#二powershell>二、Powershell</a><ul><li><a href=#1-实用命令>1. 实用命令</a></li><li><a href=#2-进程相关命令>2. 进程相关命令</a></li><li><a href=#3-网络相关命令>3. 网络相关命令</a></li><li><a href=#4-socket-信息查询---netstat>4. socket 信息查询 - netstat</a></li></ul></li><li><a href=#三mac-os-x>三、Mac OS X</a><ul><li><a href=#1-查看-socket-信息>1. 查看 socket 信息</a></li><li><a href=#2-其他网络相关命令>2. 其他网络相关命令</a></li></ul></li><li><a href=#四跨平台程序>四、跨平台程序</a><ul><li><a href=#1-vim>1. vim</a><ul><li><a href=#常用技巧>常用技巧</a></li><li><a href=#多行修改>多行修改</a></li><li><a href=#多行替换基本和-sed-一致>多行替换（基本和 sed 一致）</a></li><li><a href=#将选中部分写入到文件>将选中部分写入到文件</a></li><li><a href=#问题在-vim-中粘贴-yaml-时缩进会变得一团糟>问题：在 vim 中粘贴 yaml 时缩进会变得一团糟</a></li></ul></li></ul></li><li><a href=#参考>参考</a></li></ul></nav></div></div><div class=content id=content><blockquote><p>个人笔记，只会列出我自己容易忘掉的命令，方便查阅。</p></blockquote><blockquote><p>内容比较多，适合当参考手册用。可能不太适合从头读到尾&mldr;</p></blockquote><blockquote><p>本文主要介绍 Linux 命令，顺带介绍下 Windows/MacOSX.</p></blockquote><blockquote><p>其中 awk 只需要学会些常用的用法就够了，这类命令行工具比较适合临时处理一些文本，可读性与
维护性都比较差。对于需求比较复杂，而且需要长期使用的脚本，建议使用 Python/Go 等语言编
写。</p></blockquote><h2 id=一linux class=headerLink><a href=#%e4%b8%80linux class=header-mark></a>一、Linux</h2><h3 id=1-后台运行 class=headerLink><a href=#1-%e5%90%8e%e5%8f%b0%e8%bf%90%e8%a1%8c class=header-mark></a>1. 后台运行</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 1. 后台运行命令</span>
</span></span><span class=line><span class=cl>nohup python xxx.py <span class=p>&amp;</span>
</span></span></code></pre></td></tr></table></div></div><p>也可以使用 tmux，tmux 提供的 session 功能比 nohup 更好用，后面会介绍 tmux</p><h3 id=2-查找替换-sedawk-与-jsonyaml-处理-jqyq class=headerLink><a href=#2-%e6%9f%a5%e6%89%be%e6%9b%bf%e6%8d%a2-sedawk-%e4%b8%8e-jsonyaml-%e5%a4%84%e7%90%86-jqyq class=header-mark></a>2. 查找替换 sed/awk 与 json/yaml 处理 jq/yq</h3><p>grep 常用命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## 只在目录中所有的 .py 和 .dart 文件中递归搜索字符&#34;main()&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># -r 表示递归搜索</span>
</span></span><span class=line><span class=cl>grep <span class=s2>&#34;main()&#34;</span> . -r --include *.<span class=o>{</span>py, dart<span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat xxx <span class=p>|</span> grep -10 <span class=s2>&#34;main()&#34;</span>  <span class=c1># 显示匹配行的前后 10 行</span>
</span></span><span class=line><span class=cl>cat xxx <span class=p>|</span> grep -A <span class=m>10</span> -B <span class=m>5</span> <span class=s2>&#34;main()&#34;</span>  <span class=c1># 显示匹配行的前 5 行和后 10 行</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 在 .js 文件中搜索关键字 xxxxx 并仅展示关键字前后 40 个字符（用在 .js 等被压缩过的文本文件上很有效）</span>
</span></span><span class=line><span class=cl>cat *.js <span class=p>|</span> grep -o -P <span class=s1>&#39;.{0,40}xxxxx.{0,40}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 正则搜索（`egrep` 是 `grep -E` 的简写，表示使用扩展正则表达式）</span>
</span></span><span class=line><span class=cl>cat xxx <span class=p>|</span> egrep <span class=s1>&#39;pattern1|pattern2|pattern3&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 反向搜索（不包含某个关键字）</span>
</span></span><span class=line><span class=cl>cat xxx <span class=p>|</span> grep -v <span class=s1>&#39;pattern&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 高亮显示搜索结果</span>
</span></span><span class=line><span class=cl>cat xxx <span class=p>|</span> grep --color <span class=s1>&#39;pattern&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 通过 find 查找所有子文件夹中的 config.xml 文件，并在其中查找包含关键字 &lt;recipients&gt; 的行</span>
</span></span><span class=line><span class=cl><span class=c1># 再通过 awk 提取出文件名和需要的关键字</span>
</span></span><span class=line><span class=cl><span class=c1>#   -maxdepth 2 表示最大递归深度为 2（子文件夹）</span>
</span></span><span class=line><span class=cl><span class=c1>#   -exec echo \&#39;{}\&#39; \; 表示将 find 命令的输出使用 echo 命令添加单引号包裹起来，防止文件名中有空格导致 grep 命令出错</span>
</span></span><span class=line><span class=cl><span class=c1>#   xargs grep &#39;&lt;recipients&gt;&#39; 表示将 find 命令的输出作为 grep 命令的输入</span>
</span></span><span class=line><span class=cl><span class=c1>#   awk -F &#39;[:&lt;&gt;]&#39; &#39;{print $1,$4}&#39; 表示使用 : &lt; &gt; 作为分隔符，打印出第 1 列和第 4 列</span>
</span></span><span class=line><span class=cl>find -maxdepth <span class=m>2</span> -name <span class=s2>&#34;config.xml&#34;</span> -exec <span class=nb>echo</span> <span class=se>\&#39;</span><span class=o>{}</span><span class=se>\&#39;</span> <span class=se>\;</span> <span class=p>|</span> xargs grep <span class=s1>&#39;&lt;recipients&gt;&#39;</span> <span class=p>|</span> awk -F <span class=s1>&#39;[:&lt;&gt;]&#39;</span> <span class=s1>&#39;{print $1,$4}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 在文件夹中递归查找所有中文字符（在做中英双语内容维护时比较有用）</span>
</span></span><span class=line><span class=cl><span class=c1># -P 表示使用 Perl 正则表达式，[\x{4e00}-\x{9f5a}] 表示匹配所有中文字符</span>
</span></span><span class=line><span class=cl>grep -P <span class=s1>&#39;[\x{4e00}-\x{9f5a}]&#39;</span> -r .
</span></span></code></pre></td></tr></table></div></div><p>更 morden 的命令是 ripgrep，它的速度比 grep 快很多，而且默认就是正则匹配、递归搜索、高亮显
示搜索结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在当前文件夹递归搜索所有包含关键字 &#34;main()&#34; 的文件</span>
</span></span><span class=line><span class=cl><span class=c1># 注意 rg 默认使用 rust 的正则匹配库</span>
</span></span><span class=line><span class=cl><span class=c1># 也可通过 -P 参数使用 PCRE2 正则匹配库</span>
</span></span><span class=line><span class=cl>rg <span class=s2>&#34;main\(\)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 在指定文件夹递归搜索所有包含关键字 &#34;main()&#34; 的文件</span>
</span></span><span class=line><span class=cl>rg <span class=s2>&#34;main\(\)&#34;</span> &lt;path&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 类似 sed 的功能，替换文件中的字符串</span>
</span></span><span class=line><span class=cl><span class=c1>#  -N 表示不输出匹配的行，只输出替换后的结果</span>
</span></span><span class=line><span class=cl><span class=c1>#  -r 表示 replace 替换</span>
</span></span><span class=line><span class=cl>rg --passthru -N <span class=s1>&#39;and&#39;</span> -r <span class=s1>&#39;&amp;&#39;</span> ip.txt &gt; ip2.txt
</span></span></code></pre></td></tr></table></div></div><p>sed 常用命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## 1） 全文搜索并替换</span>
</span></span><span class=line><span class=cl><span class=c1>### -i --in-place 原地替换（修改原文件）</span>
</span></span><span class=line><span class=cl><span class=c1>### -i=SUFFIX  替换后的文件添加 SUFFIX 这个后缀</span>
</span></span><span class=line><span class=cl><span class=c1>### -r  使用拓展的正则表达式，注意此正则不支持 \d\w\s 等语法，必须使用 [0-9] [a-zA-Z] 等来替换！！！</span>
</span></span><span class=line><span class=cl>sed -ri <span class=s2>&#34;s/pattern_str/replace_str/g&#34;</span> <span class=sb>`</span>grep <span class=s2>&#34;key_pattern&#34;</span> <span class=s1>&#39;path_pattern&#39;</span> -rl<span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 2）文件名搜索，替换文件内容</span>
</span></span><span class=line><span class=cl>sed -ri <span class=s2>&#34;s/pattern_str/replace_str/g&#34;</span> <span class=sb>`</span>find . -name <span class=s2>&#34;pattern&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 3）批量转换大小写</span>
</span></span><span class=line><span class=cl><span class=c1># 将当前文件夹内，所有的 gitlab URL 都转换成小写</span>
</span></span><span class=line><span class=cl><span class=c1># \L 转小写  \U 转大写</span>
</span></span><span class=line><span class=cl>sed -ri <span class=s1>&#39;s@http://GITLAB.*.git@\L&amp;@g&#39;</span> <span class=sb>`</span>find . -name pubspec*<span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 只有包含 2 的行才会替换逗号为破折号</span>
</span></span><span class=line><span class=cl><span class=nb>printf</span> <span class=s1>&#39;1,2,3,4\na,b,c,d\n&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;/2/ s/,/-/g&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 只打印出被替换成功的行</span>
</span></span><span class=line><span class=cl>sed -n <span class=s1>&#39;s/warm/cool/gp&#39;</span> rhymes.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 删除掉第 3-8 行，保留其他行</span>
</span></span><span class=line><span class=cl>seq <span class=m>15</span> <span class=m>24</span> <span class=p>|</span> sed <span class=s1>&#39;3,8 d&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 删除除 3-8 行之外的所有行</span>
</span></span><span class=line><span class=cl>seq <span class=m>15</span> <span class=m>24</span> <span class=p>|</span> sed <span class=s1>&#39;3,8! d&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 删除掉第 3 行到第 11(3+8) 行，保留其他行</span>
</span></span><span class=line><span class=cl>seq <span class=m>15</span> <span class=m>24</span> <span class=p>|</span> sed <span class=s1>&#39;3,+8 d&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 对于所有包含 2 的行，都替换逗号为破折号</span>
</span></span><span class=line><span class=cl><span class=nb>printf</span> <span class=s1>&#39;1,2,3,4\na,b,c,d\n&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;/2/ s/,/-/g&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 对于所有不包含 2 的行，都替换逗号为破折号</span>
</span></span><span class=line><span class=cl><span class=nb>printf</span> <span class=s1>&#39;1,2,3,4\na,b,c,d\n&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;/2/! s/,/-/g&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 在第 2 行之后插入一行，内容为 hello</span>
</span></span><span class=line><span class=cl>seq <span class=m>1</span> <span class=m>3</span> <span class=p>|</span> sed <span class=s1>&#39;2a hello&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 将第 2 行的内容改为 hello</span>
</span></span><span class=line><span class=cl>seq <span class=m>1</span> <span class=m>3</span> <span class=p>|</span> sed <span class=s1>&#39;2c hello&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 将能匹配上指定正则表达式的行，改为 hello</span>
</span></span><span class=line><span class=cl>seq <span class=m>1</span> <span class=m>5</span> <span class=p>|</span> sed -E <span class=s1>&#39;/(11|22)/c hello&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 在第二行的前面插入一行，内容为 hello</span>
</span></span><span class=line><span class=cl>seq <span class=m>1</span> <span class=m>3</span> <span class=p>|</span> sed <span class=s1>&#39;2i hello&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 将第 2-4 行的内容改为 hello（改完后只有一行，而不是 3 行）</span>
</span></span><span class=line><span class=cl>seq <span class=m>5</span> <span class=p>|</span> sed <span class=s1>&#39;2,4c hello&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># 将第 2-4 行每一行的内容都改为 hello（改完后是 3 行）</span>
</span></span><span class=line><span class=cl>seq <span class=m>5</span> <span class=p>|</span> sed <span class=s1>&#39;2,4 s/.*/hello/&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 一次使用多条指令</span>
</span></span><span class=line><span class=cl>seq <span class=m>4</span> <span class=p>|</span> sed -e <span class=s1>&#39;2c hi&#39;</span> -e <span class=s1>&#39;3a bye&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 4) 拷贝文件，并且保持文件夹结构（--parents 表示保持文件夹结构）</span>
</span></span><span class=line><span class=cl>cp --parents <span class=sb>`</span>find &lt;src-dir&gt; -name *.py<span class=sb>`</span> &lt;dst-dir&gt;
</span></span></code></pre></td></tr></table></div></div><p>awk 用于按列处理文本，它比 sed 更强大更复杂，常用命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## 1. 单独选出第 1 列的文本</span>
</span></span><span class=line><span class=cl>cat xxx.txt <span class=p>|</span> awk -F <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> head
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 2. 可以使用 -F 指定分隔符，打印出多列</span>
</span></span><span class=line><span class=cl>awk -F <span class=s1>&#39;,&#39;</span> <span class=s1>&#39;{print $1,$2}&#39;</span><span class=p>|</span> head
</span></span><span class=line><span class=cl><span class=c1>### -F 也可以使用正则表达式指定多个分隔符</span>
</span></span><span class=line><span class=cl>awk -F <span class=s1>&#39;[,;]&#39;</span> <span class=s1>&#39;{print $1,$2}&#39;</span><span class=p>|</span> head
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 在文件开头与末尾分别添加字符串</span>
</span></span><span class=line><span class=cl>seq <span class=m>2</span> <span class=p>|</span> awk <span class=s1>&#39;BEGIN{print &#34;---&#34;} 1; END{print &#34;%%%&#34;}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 3. 打印出行数</span>
</span></span><span class=line><span class=cl>cat log_test <span class=p>|</span> awk <span class=s1>&#39;{print NR,$1}&#39;</span> <span class=p>|</span> more
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 4. if 判断语句</span>
</span></span><span class=line><span class=cl>cat log_test <span class=p>|</span> awk <span class=s1>&#39;{if($11&gt;300) print($1,$11)}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat log_test <span class=p>|</span> awk <span class=s1>&#39;{print $11}&#39;</span> <span class=p>|</span> sort -n <span class=p>|</span> uniq -c
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 求和</span>
</span></span><span class=line><span class=cl>cat data<span class=p>|</span>awk <span class=s1>&#39;{sum+=$1} END {print &#34;Sum = &#34;, sum}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 求平均</span>
</span></span><span class=line><span class=cl>cat data<span class=p>|</span>awk <span class=s1>&#39;{sum+=$1} END {print &#34;Average = &#34;, sum/NR}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 求最大值</span>
</span></span><span class=line><span class=cl>cat data<span class=p>|</span>awk <span class=s1>&#39;BEGIN {max = 0} {if ($1&gt;max) max=$1 fi} END {print &#34;Max=&#34;, max}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 求最小值（min的初始值设置一个超大数即可）</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;BEGIN {min = 1999999} {if ($1&lt;min) min=$1 fi} END {print &#34;Min=&#34;, min}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=https://github.com/stedolan/jq target=_blank rel="noopener noreferrer">jq</a>/<a href=https://github.com/mikefarah/yq target=_blank rel="noopener noreferrer">yq</a> 常用命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. jq 是一个命令行 json 处理工具</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 从 json 中查询某一个字段的值</span>
</span></span><span class=line><span class=cl>jq -r <span class=s1>&#39;.message&#39;</span> xxx.json
</span></span><span class=line><span class=cl><span class=c1>## 也可从 stdin 读取 json</span>
</span></span><span class=line><span class=cl>cat xxx.json <span class=p>|</span> jq -r <span class=s1>&#39;.message&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 从 json 内容中删除多个 key</span>
</span></span><span class=line><span class=cl><span class=c1>## -r 表示输出文本采用 raw 格式</span>
</span></span><span class=line><span class=cl>jq -r <span class=s2>&#34;del(.dataplane.insync, .dataplane.outdated)&#34;</span> xxx.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 更多 jq 的用法参见官方文档：https://stedolan.github.io/jq/tutorial/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. yq 是用于处理 yaml 配置的命令行工具，参数跟 jq 高度相似</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 从 yaml 配置中删除多个 key</span>
</span></span><span class=line><span class=cl>yq <span class=s2>&#34;del(.dataplane.insync, .dataplane.outdated)&#34;</span> xxx.yaml
</span></span><span class=line><span class=cl><span class=c1>## 或者从 stdin 读取输入</span>
</span></span><span class=line><span class=cl>cat xxx.yaml <span class=p>|</span> yq <span class=s2>&#34;del(.dataplane.insync, .dataplane.outdated)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 原地更新某 yaml 配置文件</span>
</span></span><span class=line><span class=cl>yq -i <span class=s1>&#39;.a.b[0].c = &#34;cool&#34;&#39;</span> file.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## yq 的更多用法参见官方说明: https://github.com/mikefarah/yq</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-压缩相关 class=headerLink><a href=#3-%e5%8e%8b%e7%bc%a9%e7%9b%b8%e5%85%b3 class=header-mark></a>3. 压缩相关</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 直接 cat 压缩文件的内容</span>
</span></span><span class=line><span class=cl>zcat xxx.gz <span class=p>|</span> more  <span class=c1># gzip</span>
</span></span><span class=line><span class=cl>xzcat xxx.xz <span class=p>|</span> more  <span class=c1># xz</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>tar -axvf xxx.tar.*  <span class=c1># 通过后缀识别压缩格式，智能解压</span>
</span></span></code></pre></td></tr></table></div></div><p>以及日常可通过压缩 + bas64 编码来通过 IM 等聊天软件快速传输数据量不多的文件夹：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 压缩文件夹并通过 base64 编码</span>
</span></span><span class=line><span class=cl>tar czv &lt;folder-name&gt; <span class=p>|</span> base64 &gt; xxx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 解压消息到文件夹</span>
</span></span><span class=line><span class=cl>cat <span class=s2>&#34;xxx&#34;</span> <span class=p>|</span> base64 -d <span class=p>|</span> tar zxv
</span></span></code></pre></td></tr></table></div></div><p>更多命令参见
<a href=https://thiscute.world/posts/compression-related-instructions-under-linux/ target=_blank rel="noopener noreferrer">常见压缩格式的区别，及 Linux 下的压缩相关指令</a></p><h3 id=4-文件拷贝与同步 class=headerLink><a href=#4-%e6%96%87%e4%bb%b6%e6%8b%b7%e8%b4%9d%e4%b8%8e%e5%90%8c%e6%ad%a5 class=header-mark></a>4. 文件拷贝与同步</h3><p>各种 Linux 发行版都自带 scp/ssh，这两个工具功能简单，一般够用。</p><p>另外就是更强大也更复杂的 rsync，部分发行版会自带 rsync。</p><p>下面分别介绍下。</p><h4 id=1-sshscp class=headerLink><a href=#1-sshscp class=header-mark></a>1. ssh/scp</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 如果使用 ssh 命令进行文件传输，可安装 pv 命令查看传输速度（pipeviewer）</span>
</span></span><span class=line><span class=cl><span class=c1>## ubuntu</span>
</span></span><span class=line><span class=cl>sudo apt-get install pv
</span></span><span class=line><span class=cl><span class=c1>##  centos</span>
</span></span><span class=line><span class=cl>sudo yum install epel-release
</span></span><span class=line><span class=cl>sudo yum install pv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 1)从本地上传到服务器</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>### 使用 ssh 的好处是流式传输不会占用目标机器的存储空间，适合传输可能引起空间不足的大文件，并在目标机器上实时处理该文件。</span>
</span></span><span class=line><span class=cl>cat &lt;filename&gt; <span class=p>|</span> pv <span class=p>|</span> ssh &lt;user&gt;@&lt;host&gt; -p <span class=m>22</span> <span class=s2>&#34;cat - &gt; &lt;new-filename&gt;&#34;</span>
</span></span><span class=line><span class=cl>tar cz &lt;filename or foldername or glob&gt; <span class=p>|</span> pv <span class=p>|</span> ssh &lt;user&gt;@&lt;host&gt; -p <span class=m>22</span> <span class=s2>&#34;tar xz&#34;</span>  <span class=c1># 压缩传输</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## scp 命令比 ssh 命令更简洁（但是不适合用于传文件夹，它会破坏文件的权限设置，把文件夹弄得一团糟）</span>
</span></span><span class=line><span class=cl>scp -P <span class=m>22</span> &lt;filename&gt; &lt;user&gt;@&lt;host&gt;:&lt;folder-name or filename&gt;  <span class=c1># 通过 scp 传输，传文件夹时记得添加 -r 参数（recursive）</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 2) 从服务器下载到本地</span>
</span></span><span class=line><span class=cl>ssh &lt;user&gt;@&lt;host&gt; -p <span class=m>22</span> <span class=s2>&#34;tar cz &lt;filename or foldername or glob&gt;&#34;</span> <span class=p>|</span> pv <span class=p>|</span> tar xz  <span class=c1># 压缩传输</span>
</span></span><span class=line><span class=cl>scp -P <span class=m>22</span> &lt;user&gt;@&lt;host&gt;:&lt;folder-name or filename&gt; &lt;filename&gt;  <span class=c1># 通过 scp 传输，传文件夹时记得添加 -r 参数（recursive）</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=2-rsync class=headerLink><a href=#2-rsync class=header-mark></a>2. rsync</h4><p>rsync 的功能其实和前面的 scp/(tar+ssh) 是一样的，将文件从一个地方拷贝到另一个地方。区别在
于它只做增量同步，在多次拷贝文件时，只拷贝（同步）修改过的部分，很多场景下可以大大加快拷贝
/备份速度。</p><p>rsync 的常用命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 将一个文件夹归档、压缩，并通过 ssh 协议（默认）同步到另一个地方</span>
</span></span><span class=line><span class=cl><span class=c1># -a, --archive   # 归档模式，保留文件的所有元信息，等同于 `-rlptgoD`</span>
</span></span><span class=line><span class=cl><span class=c1># -r, --recursive # 递归复制文件夹，`-a` 隐含了这个参数，通常都用 -a。</span>
</span></span><span class=line><span class=cl><span class=c1># -v, --verbose   # 输出详细信息</span>
</span></span><span class=line><span class=cl><span class=c1># --progress      # 显示传输进度</span>
</span></span><span class=line><span class=cl><span class=c1># -z, --compress  # 传输文件时进行压缩</span>
</span></span><span class=line><span class=cl>rsync -avz --progress src host:dest
</span></span><span class=line><span class=cl>rsync -avz --progress -e <span class=s2>&#34;ssh -p225&#34;</span> /path/src user@host:dest  <span class=c1># 使用非默认的 ssh 端口进行传输</span>
</span></span><span class=line><span class=cl>rsync -avz --progress -e <span class=s2>&#34;ssh -i id_xxx&#34;</span> /path/src user@host:dest  <span class=c1># 使用指定的私钥连接 ssh 服务端，其他各种 ssh 参数都可以在这里指定</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># --exclude 排除掉某些不需要的文件(夹)</span>
</span></span><span class=line><span class=cl>rsync -avz --progress --exclude <span class=s2>&#34;foor/bar&#34;</span> src user@host:dest
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 有时我们希望在同步数据时修改文件的 user/group</span>
</span></span><span class=line><span class=cl><span class=c1># --chown    # 设置文件的 user:group，必须与 `-og`/`--owner --group` 同时使用！（`-a` 隐含了 `-og`）</span>
</span></span><span class=line><span class=cl>rsync -avz --progress --chown<span class=o>=</span>root:root src user@host:dest  <span class=c1># 传输时修改 user/group 为 root</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 详细说明 src 和 dest 的位置</span>
</span></span><span class=line><span class=cl>rsync -avz --progress path/src user@host:/tmp  <span class=c1># 将 src 拷贝到远程主机的 /tmp 中（得到 /tmp/src）</span>
</span></span><span class=line><span class=cl><span class=c1>## 注意 src 结尾有 /</span>
</span></span><span class=line><span class=cl>rsync -avz --progress path/src/ user@host:/tmp/src  <span class=c1># 将 src 目录中的文件拷贝到远程主机的 /tmp/src 目录中（同样得到 /tmp/src）</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 有时候我们在传输文件时不希望保留文件的元信息</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># rsync 默认不会删除 dest 中多余的文件，使用 --delete 可让 rsync 删除这部分无关的文件</span>
</span></span><span class=line><span class=cl><span class=c1># 对 src 文件夹进行完全镜像，保证两个文件夹的内容一模一样，不多不少</span>
</span></span><span class=line><span class=cl>rsync -avz --progress --delete src user@host:dest
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 也可以使用 --ignore-existing 让 rsync 忽略掉 dest 已经存在的文件。就是只同步新增的文件。</span>
</span></span><span class=line><span class=cl>rsync -avz --progress --ignore-existing src user@host:dest
</span></span></code></pre></td></tr></table></div></div><p>另外也有使用双冒号 <code>::</code> 分隔的传输命令，这种命令使用 <code>rsync</code> 协议进行传输，要求目标主机启
用 rsync-daemon。用得会比 ssh 少一些，暂时不做介绍。</p><p>rsync 详细文档参见 <a href=https://rsync.samba.org/documentation.html target=_blank rel="noopener noreferrer">https://rsync.samba.org/documentation.html</a>，或者 <code>man rsync</code>.</p><h3 id=5-tmux class=headerLink><a href=#5-tmux class=header-mark></a>5. Tmux</h3><ol><li>输入 <code>tmux</code> 启动一个 tmux 会话。（或者用 <code>tmux new -s &lt;session-name></code> 启动一个命名会
话）</li><li>输入 <code>python xxx.py</code>，python 进程开始运行。</li><li>按快捷键 <code>ctrl+b</code>，然后再按一下 <code>d</code> 脱离(detach)当前会话。此时 python 进程进入后台运
行，关闭当前终端对 python 进程没有影响。</li><li>输入 <code>tmux ls</code> 可以查看当前正在后台运行的会话。（命名会话会显示名称，否则只显示 id）</li><li>通过 <code>tmux attach -t &lt;session-name/id></code> 重新接入后台会话。<ol><li>缩写 <code>tmux a -t &lt;session></code></li></ol></li><li>或者通过 <code>tmux kill-session -t &lt;session-name/id></code> 杀死一个后台会话。</li></ol><p>常用快捷键：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># prefix 表示 `ctrl`+`b`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># pane 的切分与选择</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix &#34; </span><span class=w> </span><span class=c># 在下方新建一个 pane</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix % </span><span class=w> </span><span class=c># 在右侧新建一个 pane</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix `方向键` </span><span class=w> </span><span class=c># 光标移动到指定方向的 pane 中</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 使用方向键滚动窗口内容</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix [ </span><span class=w> </span><span class=c># 进入翻页模式，可使用 page up/down，或者方向键来浏览 pane 的内容</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 使用鼠标滚轮来滚动窗口内容（也可以把此命令添加到 `~/.tmux.conf` 中使它永久生效）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix `:` 然后输入 `set-window-option -g mode-mouse on`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># （调整 pane 大小）将当前的 pane 向给定的方向扩容 5 行或者 5 列</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 按住 ALT 时快速重复敲击「方向键」，能快速调整，否则就得从 prefix 开始重新输入</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix `Alt` + `方向键`</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 将当前窗格全屏显示，第二次使用此命令，会将窗格还原</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix z</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 交换 pane 的位置</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix { </span><span class=w> </span><span class=c># 当前窗格与上一个窗格交换位置</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix } </span><span class=w> </span><span class=c># 当前窗格与下一个窗格交换位置</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># session 相关操作</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix s </span><span class=w> </span><span class=c># 查看 session 列表，并通过方向键选择 session</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix `number` </span><span class=w> </span><span class=c># 通过数字标签选择 session</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># window 相关操作（关系：每个 session 可以包含多个 window，每个 window 里面又可以有多个 pane）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix c</span><span class=w> </span><span class=c># 新建 window</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>prefix w</span><span class=w> </span><span class=c># 通过数字标签选择 window</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>参考文档：</p><ul><li><a href=https://github.com/tmux/tmux/wiki/Getting-Started target=_blank rel="noopener noreferrer">https://github.com/tmux/tmux/wiki/Getting-Started</a></li><li><a href=https://www.ruanyifeng.com/blog/2019/10/tmux.html target=_blank rel="noopener noreferrer">https://www.ruanyifeng.com/blog/2019/10/tmux.html</a></li></ul><h3 id=6-bash-shell-基础 class=headerLink><a href=#6-bash-shell-%e5%9f%ba%e7%a1%80 class=header-mark></a>6. Bash Shell 基础</h3><p>目标：能使用 shell 编写 10 行以内的脚本。更长的脚本可以使用 Python 编写，就没必要折腾
Shell 了。</p><h4 id=1-for-循环 class=headerLink><a href=#1-for-%e5%be%aa%e7%8e%af class=header-mark></a>1. For 循环</h4><p>单行 for 循环，有时候很有用：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 数字枚举</span>
</span></span><span class=line><span class=cl><span class=k>for</span> i in <span class=k>$(</span>seq <span class=m>1</span> 5<span class=k>)</span><span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=nv>$i</span><span class=p>;</span> <span class=k>done</span>  <span class=c1># sh/bash 都支持</span>
</span></span><span class=line><span class=cl><span class=k>for</span> i in <span class=o>{</span>1..5<span class=o>}</span><span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=nv>$i</span><span class=p>;</span> <span class=k>done</span>  <span class=c1># sh 不支持此语法</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 文件枚举，可使用 glob 语法进行文件匹配</span>
</span></span><span class=line><span class=cl><span class=k>for</span> f in *<span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=nv>$f</span><span class=p>;</span> <span class=k>done</span>
</span></span><span class=line><span class=cl><span class=k>for</span> f in /etc/*.py<span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=nv>$f</span><span class=p>;</span> <span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用 find 进行文件枚举</span>
</span></span><span class=line><span class=cl><span class=k>for</span> f in <span class=k>$(</span>find . -name *.py<span class=k>)</span><span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=nv>$f</span><span class=p>;</span> <span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><p>单行 for 循环加几个换行就得到多行 for 循环，格式如下：写脚本用得到，不过更建议用 python:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>for</span> i in <span class=k>$(</span>seq <span class=m>1</span> 5<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=nv>$i</span>
</span></span><span class=line><span class=cl><span class=k>done</span>  <span class=c1># sh/bash 都支持</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=2-if-语句 class=headerLink><a href=#2-if-%e8%af%ad%e5%8f%a5 class=header-mark></a>2. if 语句</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 单行 if 语句</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=nb>true</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span> &lt;command&gt;<span class=p>;</span> <span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#  if else</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> expression <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>   Statement<span class=o>(</span>s<span class=o>)</span> to be executed <span class=k>if</span> expression is <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>   Statement<span class=o>(</span>s<span class=o>)</span> to be executed <span class=k>if</span> expression is not <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=3-shell-脚本中的-set-指令比如-set--x-和-set--e class=headerLink><a href=#3-shell-%e8%84%9a%e6%9c%ac%e4%b8%ad%e7%9a%84-set-%e6%8c%87%e4%bb%a4%e6%af%94%e5%a6%82-set--x-%e5%92%8c-set--e class=header-mark></a>3. Shell 脚本中的 set 指令，比如 set -x 和 set -e</h4><p>参
见：<a href=https://www.cnblogs.com/robinunix/p/11635560.html target=_blank rel="noopener noreferrer">Shell 脚本中的 set 指令，比如 set -x 和 set -e</a></p><h4 id=4-实用小工具 class=headerLink><a href=#4-%e5%ae%9e%e7%94%a8%e5%b0%8f%e5%b7%a5%e5%85%b7 class=header-mark></a>4. 实用小工具</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># URL 编解码</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>urldecode</span><span class=o>=</span><span class=s1>&#39;python3 -c &#34;import sys, urllib.parse as ul; print(ul.unquote_plus(sys.stdin.read()))&#34;&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>urlencode</span><span class=o>=</span><span class=s1>&#39;python3 -c &#34;import sys, urllib.parse as ul; print(ul.quote_plus(sys.stdin.read()))&#34;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 使用方法</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;xxx&#34;</span> <span class=p>|</span> urldecode
</span></span><span class=line><span class=cl>cat file <span class=p>|</span> urlencode
</span></span></code></pre></td></tr></table></div></div><h4 id=5-查询历史记录 class=headerLink><a href=#5-%e6%9f%a5%e8%af%a2%e5%8e%86%e5%8f%b2%e8%ae%b0%e5%bd%95 class=header-mark></a>5. 查询历史记录</h4><p>临时版：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 查询命令行历史记录，并带上时间</span>
</span></span><span class=line><span class=cl><span class=nv>HISTTIMEFORMAT</span><span class=o>=</span><span class=s2>&#34;%F %T %z &#34;</span> <span class=nb>history</span>
</span></span></code></pre></td></tr></table></div></div><p>一劳永逸版：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 将环境变量加入 .bashrc</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;HISTTIMEFORMAT=&#34;%F %T &#34;&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span class=line><span class=cl><span class=nb>source</span> ~/.bashrc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查询历史记录</span>
</span></span><span class=line><span class=cl><span class=nb>history</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=6-其他资料 class=headerLink><a href=#6-%e5%85%b6%e4%bb%96%e8%b5%84%e6%96%99 class=header-mark></a>6. 其他资料</h4><ul><li><a href=https://github.com/mritd/shell_scripts target=_blank rel="noopener noreferrer">shell_scripts</a>: 实用 shell 小脚本</li></ul><h3 id=socket-commands class=headerLink><a href=#socket-commands class=header-mark></a>7. socket 连接查询 - ss/netcat/lsof</h3><p>查看 socket 信息可以帮我们回答下列问题：</p><ol><li>我的程序是不是真的在监听我指定的端口？</li><li>我的程序是在监听 127.0.0.1（本机），还是在监听 0.0.0.0（整个网络）</li><li>进程们分别在使用哪些端口？</li><li>我的连接数是否达到了上限？</li></ol><blockquote><p>现在较新版本的 Ubuntu 和 CentOS 都已经使用 <code>iproute2</code> 替换掉了 <code>net-tools</code>，如果你还需要
使用陈旧的 <code>route</code> <code>netstat</code> 等命令，需要手动安装 <code>net-tools</code>。</p></blockquote><p>我们可以使用 ss(socket statistics) 或者 netstat 命令来查看 socket 信息:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 查看 socket 连接的统计信息</span>
</span></span><span class=line><span class=cl><span class=c1># 主要统计处于各种状态的 tcp sockets 数量，以及其他 sockets 的统计信息</span>
</span></span><span class=line><span class=cl>ss --summary
</span></span><span class=line><span class=cl>ss -s  <span class=c1># 缩写</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看哪个进程在监听 80 端口</span>
</span></span><span class=line><span class=cl><span class=c1># --listening 列出所有正在被监听的 socket</span>
</span></span><span class=line><span class=cl><span class=c1># --processes 显示出每个 socket 对应的 process 名称和 pid</span>
</span></span><span class=line><span class=cl><span class=c1># --numeric 直接打印数字端口号（不解析协议名称）</span>
</span></span><span class=line><span class=cl>ss --listening --processes --numeric <span class=p>|</span> grep <span class=m>80</span>
</span></span><span class=line><span class=cl>ss -nlp <span class=p>|</span> grep <span class=m>80</span>  <span class=c1># 缩写</span>
</span></span><span class=line><span class=cl>ss -lp <span class=p>|</span> grep http  <span class=c1># 解析协议名称，然后通过协议名搜索监听</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 使用过时的 netstat</span>
</span></span><span class=line><span class=cl><span class=c1>### -t tcp</span>
</span></span><span class=line><span class=cl><span class=c1>### -u udp</span>
</span></span><span class=line><span class=cl>netstat -tunlp <span class=p>|</span> grep <span class=s2>&#34;:80&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看 sshd 当前使用的端口号</span>
</span></span><span class=line><span class=cl>ss --listening --processes <span class=p>|</span> grep sshd
</span></span><span class=line><span class=cl><span class=c1>## 使用过时的 netstat</span>
</span></span><span class=line><span class=cl>netstat -tunlp <span class=p>|</span> grep &lt;pid&gt;  <span class=c1># pid 通过 ps 命令获得</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 列出所有的 tcp sockets，包括所有的 socket 状态</span>
</span></span><span class=line><span class=cl>ss --tcp --all
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 只列出正在 listen 的 socket</span>
</span></span><span class=line><span class=cl>ss --listening
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 列出所有 ESTABLISHED 的 socket（默认行为）</span>
</span></span><span class=line><span class=cl>ss
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 统计 TCP 连接数</span>
</span></span><span class=line><span class=cl>ss <span class=p>|</span> grep ESTAB <span class=p>|</span> wc -l
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 列出所有 ESTABLISHED 的 socket，并且给出连接的计时器</span>
</span></span><span class=line><span class=cl>ss --options
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看所有来自 192.168.5 的 sockets</span>
</span></span><span class=line><span class=cl>ss dst 192.168.1.5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看本机与服务器 192.168.1.100 建立的 sockets</span>
</span></span><span class=line><span class=cl>ss src 192.168.1.5
</span></span></code></pre></td></tr></table></div></div><p>TCP 连接数受 Linux 文件描述符上限控制，可以通过如下方法查看已用文件句柄的数量。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 已用文件描述符数量</span>
</span></span><span class=line><span class=cl>lsof <span class=p>|</span> wc -l
</span></span><span class=line><span class=cl><span class=c1># 文件描述符上限</span>
</span></span><span class=line><span class=cl><span class=nb>ulimit</span> -n
</span></span></code></pre></td></tr></table></div></div><h3 id=8-其他网络相关命令 class=headerLink><a href=#8-%e5%85%b6%e4%bb%96%e7%bd%91%e7%bb%9c%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4 class=header-mark></a>8. 其他网络相关命令</h3><p>主要是 iproute2 dhclient lsof 等</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 查看路由表</span>
</span></span><span class=line><span class=cl>routel       <span class=c1># 旧的 net-tools 包中的命令</span>
</span></span><span class=line><span class=cl>ip route ls  <span class=c1># iproute2 提供的新命令</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># DHCP，先释放旧租约，再建立新租约</span>
</span></span><span class=line><span class=cl>sudo dhclient -r eth0 <span class=o>&amp;&amp;</span> sudo dhclient eth0
</span></span><span class=line><span class=cl><span class=c1># 查看 DHCP 租期</span>
</span></span><span class=line><span class=cl>cat /var/lib/dhcp/dhcpd.leases
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 清理 DNS 缓存</span>
</span></span><span class=line><span class=cl><span class=c1>## 1. 如果你使用的是 systemd-resolve，使用此命令</span>
</span></span><span class=line><span class=cl>sudo systemd-resolve --flush-caches
</span></span><span class=line><span class=cl>sudo systemd-resolve --statistics  <span class=c1># 查看缓存状态</span>
</span></span><span class=line><span class=cl><span class=c1>## 2. 如果使用的是 dnsmasq，使用此命令</span>
</span></span><span class=line><span class=cl>sudo systemctl restart dnsmasq
</span></span><span class=line><span class=cl>sudo killall -HUP dnsmasq  <span class=c1># 直接发送 HUP 信号也可以</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=9-容器网络诊断---nsenter class=headerLink><a href=#9-%e5%ae%b9%e5%99%a8%e7%bd%91%e7%bb%9c%e8%af%8a%e6%96%ad---nsenter class=header-mark></a>9. 容器网络诊断 - nsenter</h3><p>Docker 容器有自己的 namespace，直接通过宿主机的 ss 命令是查看不到容器的 socket 信息的。</p><p>比较直观的方法是直接通过 <code>docker exec</code> 在容器中通过 ss 命令。但是这要求容器中必须自带 ss
等程序，有的精简镜像可能不会自带它。</p><p>通过 <code>nsenter</code> 可以直接进入到容器的指定 namespace 中，这样就能直接查询容器网络相关的信息
了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker ps <span class=p>|</span> grep xxx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>CONTAINER</span><span class=o>=</span>xxx  <span class=c1># 容器名称或 ID</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. 查询到容器对应的 pid</span>
</span></span><span class=line><span class=cl><span class=nv>PID</span><span class=o>=</span><span class=k>$(</span>docker inspect --format <span class=o>{{</span>.State.Pid<span class=o>}}</span> <span class=nv>$CONTAINER</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. nsenter 通过 pid 进入容器的 network namespace，执行 ss 查看 socket 信息</span>
</span></span><span class=line><span class=cl>nsenter --target <span class=nv>$PID</span> --net ss -s
</span></span></code></pre></td></tr></table></div></div><p><code>nsenter</code> 这个工具貌似是 docker 自带的或者是系统内置命令，只要装了 docker，ubuntu/centos
都可以直接使用这个命令。</p><blockquote><p>nsenter 是一个进入名字空间的工具，功能不仅仅局限在「网络诊断」，还有更多用法。</p></blockquote><h3 id=10-用户与群组 class=headerLink><a href=#10-%e7%94%a8%e6%88%b7%e4%b8%8e%e7%be%a4%e7%bb%84 class=header-mark></a>10. 用户与群组</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>## 查看用户属于哪些群组</span>
</span></span><span class=line><span class=cl>groups &lt;user-name&gt;  <span class=c1># 方法一</span>
</span></span><span class=line><span class=cl>id &lt;username&gt;       <span class=c1># 方法二，它会额外列出 gid/uid</span>
</span></span><span class=line><span class=cl>cat /etc/group <span class=p>|</span> grep &lt;user-name&gt;  <span class=c1># 方法三，直接查看配置</span>
</span></span><span class=line><span class=cl><span class=c1>## 查看群组中有哪些用户，第一列是群组，最后一列是用户名</span>
</span></span><span class=line><span class=cl>cat /etc/group <span class=p>|</span> grep &lt;group-name&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=二powershell class=headerLink><a href=#%e4%ba%8cpowershell class=header-mark></a>二、Powershell</h2><p>Powershell 是微软推出的一款新一代 shell，它的特点之一是，命令都有一致的命名规则：<strong>谓词-名
词</strong>，谓词表示动作：Get/Set/Stop/Start 等，名词指示操作对
象：Service/Member/ChildItem/Command 等。</p><p>这样的命名格式使我们可以很容易地猜测到自己需要的命令的名称。</p><p>为了使用方便，powershell 还提供了一些常用命令的缩写，并且添加了大量类似 Linux 命令的别名。</p><p>还有就是，Windows 默认不区分字母大小写，日常使用可以全部小写。</p><h3 id=1-实用命令 class=headerLink><a href=#1-%e5%ae%9e%e7%94%a8%e5%91%bd%e4%bb%a4 class=header-mark></a>1. 实用命令</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># 删除文件/文件夹</span>
</span></span><span class=line><span class=cl><span class=nb>remove-item</span> <span class=n>xxx</span>  <span class=n>-confirm</span>
</span></span><span class=line><span class=cl><span class=nb>ri </span><span class=n>xxx</span>  <span class=c># 别名1</span>
</span></span><span class=line><span class=cl><span class=nb>rm </span><span class=n>xxx</span>  <span class=c># 别名2</span>
</span></span><span class=line><span class=cl><span class=nb>rmdir </span><span class=n>xxx</span>  <span class=c># etc...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 复制</span>
</span></span><span class=line><span class=cl><span class=nb>copy-item</span> <span class=n>xxx</span> <span class=n>xx</span> <span class=n>-r</span>
</span></span><span class=line><span class=cl><span class=nb>cp </span><span class=n>-r</span> <span class=n>xxx</span> <span class=n>xx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 显示工作目录</span>
</span></span><span class=line><span class=cl><span class=nb>get-location</span>
</span></span><span class=line><span class=cl><span class=nb>gl
</span></span></span><span class=line><span class=cl><span class=nb>pwd
</span></span></span><span class=line><span class=cl><span class=nb></span>
</span></span><span class=line><span class=cl><span class=c># 切换工作目录</span>
</span></span><span class=line><span class=cl><span class=nb>set-location</span> <span class=n>xxx</span>
</span></span><span class=line><span class=cl><span class=nb>sl </span><span class=n>xxx</span>
</span></span><span class=line><span class=cl><span class=nb>cd </span><span class=n>xxx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 查看环境变量</span>
</span></span><span class=line><span class=cl><span class=nb>get-childitem</span> <span class=n>env</span><span class=err>:</span>
</span></span><span class=line><span class=cl><span class=nb>gci </span><span class=n>env</span><span class=err>:</span>
</span></span><span class=line><span class=cl><span class=nb>gci </span><span class=n>env</span><span class=err>:</span><span class=n>PATH</span>  <span class=c># 查看 PATH 变量</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$env:XXX</span><span class=p>=</span><span class=s2>&#34;value&#34;</span>   <span class=c># 临时设置环境变量</span>
</span></span><span class=line><span class=cl><span class=nv>$env:Path</span> <span class=p>+=</span> <span class=s2>&#34;;SomeRandomPath&#34;</span>  <span class=c># 临时在 Path 末尾添加新路径</span>
</span></span><span class=line><span class=cl><span class=c>## 以下三行命令只对 windows 有效，linux 下无效</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Environment</span><span class=p>]::</span><span class=n>SetEnvironmentVariable</span><span class=p>(</span><span class=s2>&#34;XXX&#34;</span><span class=p>,</span> <span class=nv>$env:XXX</span> <span class=p>+</span> <span class=s2>&#34;;value&#34;</span><span class=p>,</span> <span class=p>[</span><span class=no>EnvironmentVariableTarget</span><span class=p>]::</span><span class=n>User</span><span class=p>)</span>  <span class=c># 修改当前用户的环境变量（永久），只对新进程有效</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Environment</span><span class=p>]::</span><span class=n>SetEnvironmentVariable</span><span class=p>(</span><span class=s2>&#34;XXX&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=p>,</span> <span class=p>[</span><span class=no>EnvironmentVariableTarget</span><span class=p>]::</span><span class=n>Machine</span><span class=p>)</span>  <span class=c># 给这台电脑设置环境变量（永久），只对新进程有效，需要管理员权限</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Environment</span><span class=p>]::</span><span class=n>SetEnvironmentVariable</span><span class=p>(</span><span class=s2>&#34;XXX&#34;</span><span class=p>,</span> <span class=nv>$env:XXX</span> <span class=p>+</span> <span class=s2>&#34;;value&#34;</span><span class=p>,</span> <span class=s2>&#34;User&#34;</span><span class=p>)</span>  <span class=c># target 也可用字符串指定</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 删除文件/文件夹</span>
</span></span><span class=line><span class=cl><span class=nb>rm </span><span class=n>xxx</span>  <span class=c># 删除文件夹时会进入交互界面，按提示输入就行。</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 查看命名位置（类似 Linux Shell 的 which）</span>
</span></span><span class=line><span class=cl><span class=nb>get-command</span> <span class=n>xxx</span>
</span></span><span class=line><span class=cl><span class=nb>gcm </span><span class=n>xxx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 通过关键字查找 powershell 命令</span>
</span></span><span class=line><span class=cl><span class=nb>gcm </span><span class=p>|</span> <span class=nb>select-string</span> <span class=p>&lt;</span><span class=n>keyword</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 通过关键字查找 powershell 命令和环境变量中的程序，比较慢</span>
</span></span><span class=line><span class=cl><span class=nb>gcm </span><span class=p>*</span> <span class=p>|</span> <span class=nb>select-string</span> <span class=p>&lt;</span><span class=n>keyword</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 查看别名对应的真实命令</span>
</span></span><span class=line><span class=cl><span class=nb>get-alias</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 类似 linux 的 find/ls 命令</span>
</span></span><span class=line><span class=cl><span class=nb>get-childitem</span> <span class=n>-Recurse</span> <span class=n>-Include</span> <span class=p>*.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=nb>gci </span><span class=n>-r</span> <span class=n>-i</span> <span class=p>*.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 清空终端的输出</span>
</span></span><span class=line><span class=cl><span class=nb>clear-host</span>
</span></span><span class=line><span class=cl><span class=nb>clear
</span></span></span><span class=line><span class=cl><span class=nb></span>
</span></span><span class=line><span class=cl><span class=c># 查看文件内容</span>
</span></span><span class=line><span class=cl><span class=nb>get-content</span> <span class=n>xx</span><span class=p>.</span><span class=py>py</span> <span class=p>|</span> <span class=n>more</span>
</span></span><span class=line><span class=cl><span class=nb>get-content</span> <span class=n>xx</span><span class=p>.</span><span class=py>py</span> <span class=p>|</span> <span class=nb>out-host</span> <span class=n>-paging</span>
</span></span><span class=line><span class=cl><span class=nb>cat </span><span class=n>xx</span><span class=p>.</span><span class=py>py</span>
</span></span><span class=line><span class=cl><span class=nb>gc </span><span class=n>xx</span><span class=p>.</span><span class=py>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 字符串搜索，不能对对象使用</span>
</span></span><span class=line><span class=cl><span class=c># 类似 linux 的 grep 命令</span>
</span></span><span class=line><span class=cl><span class=nb>cat </span><span class=n>xxx</span><span class=p>.</span><span class=py>log</span> <span class=p>|</span> <span class=nb>select-string</span> <span class=p>&lt;</span><span class=n>pattern</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nb>gci </span><span class=n>env</span><span class=err>:</span> <span class=p>|</span> <span class=nb>out-string</span>  <span class=n>-stream</span> <span class=p>|</span> <span class=nb>select-string</span> <span class=p>&lt;</span><span class=n>pattern</span><span class=p>&gt;</span>  <span class=c># 需要先使用 out-string 将对象转换成 string</span>
</span></span><span class=line><span class=cl><span class=nb>gci </span><span class=n>env</span><span class=err>:</span> <span class=p>|</span> <span class=nb>where-object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Name</span> <span class=o>-like</span> <span class=p>&lt;</span><span class=n>pattern</span><span class=p>&gt;}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 计算输出的行数/对象个数</span>
</span></span><span class=line><span class=cl><span class=nb>gci </span><span class=n>env</span><span class=err>:</span> <span class=p>|</span> <span class=nb>measure-object</span>
</span></span><span class=line><span class=cl><span class=nb>gci </span><span class=n>env</span><span class=err>:</span> <span class=p>|</span> <span class=nb>measure </span> <span class=c># 这是缩写</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 关机/重启</span>
</span></span><span class=line><span class=cl><span class=nb>stop-computer</span>
</span></span><span class=line><span class=cl><span class=nb>restart-computer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># windows 计算 hash 值</span>
</span></span><span class=line><span class=cl><span class=c># 功能等同于 linux 下的 sha256sum/sha1sum/sha512sum/md5sum</span>
</span></span><span class=line><span class=cl><span class=nb>Get-FileHash</span> <span class=n>-Path</span> <span class=p>/</span><span class=n>path</span><span class=p>/</span><span class=n>to</span><span class=p>/</span><span class=n>file</span> <span class=n>-Algorithm</span> <span class=n>SHA256</span>
</span></span><span class=line><span class=cl><span class=nb>Get-FileHash</span> <span class=n>-Path</span> <span class=p>/</span><span class=n>path</span><span class=p>/</span><span class=n>to</span><span class=p>/</span><span class=n>file</span> <span class=n>-Algorithm</span> <span class=n>SHA256</span>  <span class=p>|</span> <span class=nb>Format-List</span>  <span class=c># 用 format 修改格式化效果</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># base64 编解码</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Convert</span><span class=p>]::</span><span class=n>ToBase64String</span><span class=p>([</span><span class=no>Text.Encoding</span><span class=p>]::</span><span class=n>UTF8</span><span class=p>.</span><span class=py>GetBytes</span><span class=p>(</span><span class=s2>&#34;xxx&#34;</span><span class=p>))</span>  <span class=c># base64 编码</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Text.Encoding</span><span class=p>]::</span><span class=n>UTF8</span><span class=p>.</span><span class=py>GetString</span><span class=p>([</span><span class=no>Convert</span><span class=p>]::</span><span class=n>FromBase64String</span><span class=p>(</span><span class=s2>&#34;eHh4&#34;</span><span class=p>))</span>  <span class=c># 解码</span>
</span></span></code></pre></td></tr></table></div></div><p>另外 windows 同样自带 ssh/scp 命令，参数也和 linux 一致</p><h3 id=2-进程相关命令 class=headerLink><a href=#2-%e8%bf%9b%e7%a8%8b%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4 class=header-mark></a>2. 进程相关命令</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># 查看所有进程</span>
</span></span><span class=line><span class=cl><span class=nb>get-process</span> <span class=p>|</span> <span class=n>more</span>
</span></span><span class=line><span class=cl><span class=nb>ps </span><span class=p>|</span> <span class=n>more</span>  <span class=c># 别名</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 查找某进程（替代掉 tasklist）</span>
</span></span><span class=line><span class=cl><span class=nb>get-process</span> <span class=n>-name</span> <span class=n>exp</span><span class=p>*,</span><span class=n>power</span><span class=p>*</span>  <span class=c># 使用正则查找进程</span>
</span></span><span class=line><span class=cl><span class=nb>get-process</span> <span class=p>|</span> <span class=nb>select-string</span> <span class=p>&lt;</span><span class=n>pattern</span><span class=p>&gt;</span>  <span class=c># 效果同上</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 通过 id 杀掉某进程（替代掉 taskkill）</span>
</span></span><span class=line><span class=cl><span class=c># 也可以通过 -Name 用正则匹配进程</span>
</span></span><span class=line><span class=cl><span class=nb>stop-process</span> <span class=p>&lt;</span><span class=n>pid</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nb>kill </span><span class=p>&lt;</span><span class=n>pid</span><span class=p>&gt;</span>  <span class=c># 别名</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-网络相关命令 class=headerLink><a href=#3-%e7%bd%91%e7%bb%9c%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4 class=header-mark></a>3. 网络相关命令</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c>## 1. dns 相关(dns-client)</span>
</span></span><span class=line><span class=cl><span class=nb>Clear-DnsClientCache</span>  <span class=c># 清除 dns 缓存（替换掉 `ipconfig /flushdns`）</span>
</span></span><span class=line><span class=cl><span class=nb>Get-DnsClientCache</span>  <span class=c># 查看 dns 缓存</span>
</span></span><span class=line><span class=cl><span class=nb>Resolve-DnsName</span> <span class=n>baidu</span><span class=p>.</span><span class=py>com</span>  <span class=c># 解析域名</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 更新 DHCP 租约</span>
</span></span><span class=line><span class=cl><span class=n>ipconfig</span> <span class=p>/</span><span class=n>renew</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>## 2. TCP/IP 相关命令</span>
</span></span><span class=line><span class=cl><span class=nb>Get-Command</span> <span class=nb>Get-Net</span><span class=p>*</span>  <span class=c># 查看所有 TCP/IP 相关的命令</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Get-NetIPAddress</span>  <span class=c># 查看 IP 地址</span>
</span></span><span class=line><span class=cl><span class=nb>Get-NetIPInterface</span>  <span class=c># 查看 IP 接口</span>
</span></span><span class=line><span class=cl><span class=nb>Get-NetRoute</span>        <span class=c># 查看路由表</span>
</span></span><span class=line><span class=cl><span class=nb>Get-NetNeighbor</span>     <span class=c># 获取链路层 MAC 地址缓存</span>
</span></span><span class=line><span class=cl><span class=nb>Get-NetTCPConnection</span>   <span class=c># 查看 TCP 连接</span>
</span></span><span class=line><span class=cl><span class=c>### 也可以对 TCP/IP 的 IP 地址、接口、路由表进行增删改</span>
</span></span><span class=line><span class=cl><span class=nb>New-NetRoute</span>
</span></span><span class=line><span class=cl><span class=nb>Remove-NetNeighbor</span>  <span class=c># 清除 MAC 地址缓存</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=4-socket-信息查询---netstat class=headerLink><a href=#4-socket-%e4%bf%a1%e6%81%af%e6%9f%a5%e8%af%a2---netstat class=header-mark></a>4. socket 信息查询 - netstat</h3><p>Windows 系统和 macOS 一样，也没有 <code>ss</code>，但是自带 <code>netstat</code>，该命令和 Linux 下的 <code>netstat</code>
有一定差别，具体使用方法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>netstat</span> <span class=p>-?</span>  <span class=c># 查看使用帮助，很清晰易懂</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 查看那个进程在监听 80 端口，最后一列是进程的 Pid</span>
</span></span><span class=line><span class=cl><span class=n>netstat</span> <span class=n>-ano</span> <span class=p>|</span> <span class=n>findstr</span> <span class=mf>80</span>        <span class=c># windows 命令</span>
</span></span><span class=line><span class=cl><span class=n>netstat</span> <span class=n>-ano</span> <span class=p>|</span> <span class=nb>select-string</span> <span class=mf>80</span>  <span class=c># powershell 命令，就是把 findstr 替换成 select-string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 不仅列出 Pid，还给出 Pid 对应的可执行文件名称（需要管理员权限）</span>
</span></span><span class=line><span class=cl><span class=n>netstat</span> <span class=n>-ano</span> <span class=n>-b</span> <span class=p>|</span> <span class=nb>select-string</span> <span class=mf>80</span>  <span class=c># powershell 命令</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 列出所有 ESTABLISHED 的 socket（默认行为）</span>
</span></span><span class=line><span class=cl><span class=n>netstat</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 列出所有正在监听的端口</span>
</span></span><span class=line><span class=cl><span class=n>netstat</span> <span class=n>-ano</span> <span class=p>|</span> <span class=n>findstr</span> <span class=n>LISTENING</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 只列出 TCP 连接</span>
</span></span><span class=line><span class=cl><span class=n>netstat</span> <span class=n>-ano</span> <span class=n>-p</span> <span class=n>TCP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># 查看路由表</span>
</span></span><span class=line><span class=cl><span class=n>route</span> <span class=p>-?</span>  <span class=c># 查看使用帮助，很清晰易懂</span>
</span></span><span class=line><span class=cl><span class=n>route</span> <span class=n>print</span>    <span class=c># 查看所有路由信息</span>
</span></span><span class=line><span class=cl><span class=n>route</span> <span class=n>print</span> <span class=mf>-4</span>  <span class=c># 仅 ipv4</span>
</span></span></code></pre></td></tr></table></div></div><p>比如我们遇到端口占用问题时，就可以通过上述命令查找到端口对应的 Pid，然后使用 <code>kill &lt;Pid></code>
命令（powershell <code>stop-process</code> 的别名）杀死对应的进程。</p><h2 id=三mac-os-x class=headerLink><a href=#%e4%b8%89mac-os-x class=header-mark></a>三、Mac OS X</h2><p>Mac OS X 系统也是 unix-like 系统，也使用 zsh/bash，因此大部分命令基本都跟 Linux 没啥区别，
可以直接参考前面 Linux 一节的内容。</p><p>但是要注意一些坑：</p><ul><li>macos 自带的 tar 并不是 gnutar，命令使用方式不一样！<ul><li>解决：<code>brew install gnu-tar</code>，安装好后通过 <code>gtar</code> 调用，参数就跟 linux 一致了。</li></ul></li><li>网络相关的命令区别较大，后面会详细介绍。</li><li>MacOSX 使用 launchpad 作为系统服务管理器，跟 systemd 区别很大。</li></ul><h3 id=1-查看-socket-信息 class=headerLink><a href=#1-%e6%9f%a5%e7%9c%8b-socket-%e4%bf%a1%e6%81%af class=header-mark></a>1. 查看 socket 信息</h3><p>Mac OS X 系统目前没有 <code>ss</code>，但是自带 <code>netstat</code>，该命令和 Linux 下的 <code>netstat</code> 有一定差别，
而且还很慢，还不能显示 pid.</p><p>所以 stackoverflow 上更推荐使用 <code>lsof</code>，几条常用命令记录如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># -n 表示不显示主机名</span>
</span></span><span class=line><span class=cl><span class=c1># -P 表示不显示端口俗称</span>
</span></span><span class=line><span class=cl><span class=c1># 不加 sudo 只能查看以当前用户运行的程序</span>
</span></span><span class=line><span class=cl><span class=c1># 通用格式：</span>
</span></span><span class=line><span class=cl>sudo lsof -nP -iTCP:端口号 -sTCP:LISTEN
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看所有 tcp 连接</span>
</span></span><span class=line><span class=cl>lsof -nP -iTCP
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看所有监听端口相关的信息（command/pid）</span>
</span></span><span class=line><span class=cl>lsof -nP -iTCP -sTCP:LISTEN
</span></span></code></pre></td></tr></table></div></div><h3 id=2-其他网络相关命令 class=headerLink><a href=#2-%e5%85%b6%e4%bb%96%e7%bd%91%e7%bb%9c%e7%9b%b8%e5%85%b3%e5%91%bd%e4%bb%a4 class=header-mark></a>2. 其他网络相关命令</h3><p>清理 DNS 缓存：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># macos 10.10+</span>
</span></span><span class=line><span class=cl>sudo dscacheutil -flushcache
</span></span><span class=line><span class=cl>sudo killall -HUP mDNSResponder
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 其他版本请自己网上搜...</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 查看所有网络接口及相关参数（ip/mac/type...）</span>
</span></span><span class=line><span class=cl>ifconfig
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看路由表</span>
</span></span><span class=line><span class=cl>netstat -nr
</span></span></code></pre></td></tr></table></div></div><h2 id=四跨平台程序 class=headerLink><a href=#%e5%9b%9b%e8%b7%a8%e5%b9%b3%e5%8f%b0%e7%a8%8b%e5%ba%8f class=header-mark></a>四、跨平台程序</h2><h3 id=1-vim class=headerLink><a href=#1-vim class=header-mark></a>1. vim</h3><h4 id=常用技巧 class=headerLink><a href=#%e5%b8%b8%e7%94%a8%e6%8a%80%e5%b7%a7 class=header-mark></a>常用技巧</h4><p>移动：</p><ul><li><code>0</code>/<code>^</code> 回到行首，<code>$</code> 去到行末</li><li>w 跳到下个单词的首部，e 跳到下个单词末尾<ul><li>也能使用 2w 2e 这种命令按单词数量跳转</li></ul></li></ul><p>删除 <code>d</code> 或修改 <code>c</code>:</p><ul><li>dw 删除单词，d2w 删除两个单词</li><li>d$ 删除到行末，<code>d0</code>/<code>d^</code> 删除到行首</li><li><code>d(</code>/<code>d{</code>/<code>d[[</code> 删除到文件首部，<code>d)</code>/<code>d}</code>/<code>d]]</code> 删除到文件末尾</li><li><code>r</code> 替换一个字符，<code>R</code> 持续往后替换</li></ul><h4 id=多行修改 class=headerLink><a href=#%e5%a4%9a%e8%a1%8c%e4%bf%ae%e6%94%b9 class=header-mark></a>多行修改</h4><p>多行插入，主要用于加注释之类的：</p><ul><li>光标停留在你需要插入文本的地方</li><li><code>ctrl</code>+<code>v</code> 进入 visual block 模式，选中多行</li><li>输入 <code>I</code>，进入编辑模式</li><li>输入 <code>#</code> 注释或者其他字符，但是注意不能输入换行符！也不能删除？</li><li>按两下 <code>Esc</code>，依次退出 Insert 和 visual block 模式，就插入成功了</li></ul><p>多行删除：</p><ul><li><code>v</code> 进入 visual 模式，在第一行，选中你想要删除的文本块<ul><li>或者也可以先进入 visual block 模式，再通过左右方向键选择文本。</li></ul></li><li><code>ctrl</code>+<code>v</code> 进入 visual block 模式，选中多行<ul><li>visual block 的特点是它是垂直选择，而 visual 模式是段落选择</li></ul></li><li>按 <code>d</code> 键就能删除被选中的所有内容。</li></ul><h4 id=多行替换基本和-sed-一致 class=headerLink><a href=#%e5%a4%9a%e8%a1%8c%e6%9b%bf%e6%8d%a2%e5%9f%ba%e6%9c%ac%e5%92%8c-sed-%e4%b8%80%e8%87%b4 class=header-mark></a>多行替换（基本和 sed 一致）</h4><p>多行行首插入注释符号 <code>#</code></p><pre><code>  :1,6 s/^/#/g
  :2,$ s/^/#/g   注：此为2行至尾行
  :% s/^/#/g     注：此为所有行
</code></pre><p>这里使用了正则表达式 <code>^</code> 匹配行首，改成 <code>$</code> 就可在行尾进行批量修改。</p><p>此外，它的分隔符也不仅限于 <code>\</code>，也可以用 <code>@</code> 等符号，方便阅读。比如：</p><pre><code>  :1,6 s@^@#@g
  :2,$ s@^@#@g   注：此为2行至尾行
  :% s@^@#@g     注：此为所有行
</code></pre><p>使用 vim 的这个正则匹配功能，不仅能进行插入，也能完成删除、替换的功能。</p><h4 id=将选中部分写入到文件 class=headerLink><a href=#%e5%b0%86%e9%80%89%e4%b8%ad%e9%83%a8%e5%88%86%e5%86%99%e5%85%a5%e5%88%b0%e6%96%87%e4%bb%b6 class=header-mark></a>将选中部分写入到文件</h4><ul><li>首先按 <code>v</code> 进入 visual 模式，选中需要的内容</li><li>按 <code>:</code>，应该会显示 <code>:'&lt;,'></code>，表示对选中部分进行操作</li><li>输入内容 <code>w new.txt</code>，此时显示效果应该是 <code>:'&lt;,'>w new.txt</code></li><li>回车就能完成文件写入</li></ul><h4 id=问题在-vim-中粘贴-yaml-时缩进会变得一团糟 class=headerLink><a href=#%e9%97%ae%e9%a2%98%e5%9c%a8-vim-%e4%b8%ad%e7%b2%98%e8%b4%b4-yaml-%e6%97%b6%e7%bc%a9%e8%bf%9b%e4%bc%9a%e5%8f%98%e5%be%97%e4%b8%80%e5%9b%a2%e7%b3%9f class=header-mark></a>问题：在 vim 中粘贴 yaml 时缩进会变得一团糟</h4><p>解决方法：在命令模式下输入 <code>:set paste</code> 进入粘贴模式，然后再粘贴 yaml 内容。</p><p>注意行首可能会丢失几个字符，需要手动补上。</p><h2 id=参考 class=headerLink><a href=#%e5%8f%82%e8%80%83 class=header-mark></a>参考</h2><ul><li><a href=https://zhuanlan.zhihu.com/p/45920111 target=_blank rel="noopener noreferrer">如何在 Linux 中查看进程占用的端口号</a></li><li><a href=https://github.com/jpetazzo/nsenter#how-do-i-use-nsenter target=_blank rel="noopener noreferrer">github - nsenter</a></li><li><a href=https://tonydeng.github.io/2016/07/07/use-lsof-to-replace-netstat/ target=_blank rel="noopener noreferrer">使用 lsof 代替 Mac OS X 中的 netstat 查看占用端口的程序</a></li><li><a href=https://zhuanlan.zhihu.com/p/81123584 target=_blank rel="noopener noreferrer">aws 常用命令</a></li></ul></div><h2>相关内容</h2><div class=related-container><div class=related-item-container><div class=related-image><a href=/posts/my-experience-of-nixos/><img loading=lazy src=/posts/my-experience-of-nixos/nixos-and-flakes-book-202402.webp srcset="/posts/my-experience-of-nixos/nixos-and-flakes-book-202402.webp, /posts/my-experience-of-nixos/nixos-and-flakes-book-202402.webp 1.5x, /posts/my-experience-of-nixos/nixos-and-flakes-book-202402.webp 2x" sizes=auto alt=/posts/my-experience-of-nixos/nixos-and-flakes-book-202402.webp title=/posts/my-experience-of-nixos/nixos-and-flakes-book-202402.webp height=200 width=400></a></div><h2 class=related-title><a href=/posts/my-experience-of-nixos/>OS as Code - 我的 NixOS 使用体会</a></h2></div><div class=related-item-container><div class=related-image><a href=/posts/an-incomplete-guide-to-data-security/><img loading=lazy src=/posts/an-incomplete-guide-to-data-security/datasecurity.webp srcset="/posts/an-incomplete-guide-to-data-security/datasecurity.webp, /posts/an-incomplete-guide-to-data-security/datasecurity.webp 1.5x, /posts/an-incomplete-guide-to-data-security/datasecurity.webp 2x" sizes=auto alt=/posts/an-incomplete-guide-to-data-security/datasecurity.webp title=/posts/an-incomplete-guide-to-data-security/datasecurity.webp height=200 width=400></a></div><h2 class=related-title><a href=/posts/an-incomplete-guide-to-data-security/>个人数据安全不完全指南</a></h2></div><div class=related-item-container><div class=related-image><a href=/posts/how-nixos-start-on-licheepi4a/><img loading=lazy src=/posts/how-nixos-start-on-licheepi4a/lp4a-pinout-debuglog-1.webp srcset="/posts/how-nixos-start-on-licheepi4a/lp4a-pinout-debuglog-1.webp, /posts/how-nixos-start-on-licheepi4a/lp4a-pinout-debuglog-1.webp 1.5x, /posts/how-nixos-start-on-licheepi4a/lp4a-pinout-debuglog-1.webp 2x" sizes=auto alt=/posts/how-nixos-start-on-licheepi4a/lp4a-pinout-debuglog-1.webp title=/posts/how-nixos-start-on-licheepi4a/lp4a-pinout-debuglog-1.webp height=200 width=400></a></div><h2 class=related-title><a href=/posts/how-nixos-start-on-licheepi4a/>NixOS 在 Lichee Pi 4A 上是如何启动的</a></h2></div></div><div class=sponsor><div class=sponsor-avatar><img loading=lazy src=https://thiscute.world/avatar/myself.webp srcset="https://thiscute.world/avatar/myself.webp, https://thiscute.world/avatar/myself.webp 1.5x, https://thiscute.world/avatar/myself.webp 2x" sizes=auto alt=https://thiscute.world/avatar/myself.webp title=https://thiscute.world/avatar/myself.webp></div><p class=sponsor-bio><em>如果你觉得这篇文章对你有所帮助，欢迎评论、分享、打赏~</em></p><a href=https://afdian.net/a/ryan4yin title=Sponsor target=_blank class=sponsor-button rel="noopener noreferrer"><i class="far fa-heart fa-fw icon" style=color:#ec6cb9></i>
<span>赞赏</span></a></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-02-13</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><button title="分享到 Twitter" data-sharer=twitter data-url=https://thiscute.world/posts/common-commands-for-various-operating-systems/ data-title="Linux/Windows/MacOSX 系统常用命令集锦" data-via=ryan4yin data-hashtags=Linux,MacOSX,Windows,CLI,Powershell,Shell,tmux,rsync,vim,awk><span class="fab fa-twitter fa-fw"></span></button><button title="分享到 Hacker News" data-sharer=hackernews data-url=https://thiscute.world/posts/common-commands-for-various-operating-systems/ data-title="Linux/Windows/MacOSX 系统常用命令集锦"><span class="fab fa-hacker-news fa-fw"></span></button><button title="分享到 Reddit" data-sharer=reddit data-url=https://thiscute.world/posts/common-commands-for-various-operating-systems/><span class="fab fa-reddit fa-fw"></span></button><script>function shareOnMastodon(e,t){const o="share_mastodon_domain",i=localStorage.getItem(o)??"mastodon.social",n=prompt("Enter your Mastodon domain",i);if(n===null)return;localStorage.setItem(o,n);const a=e+`

`+t,s=new URL("https://"+n);s.pathname="share",s.searchParams.append("text",a),window.open(s,"_blank","width=500,height=500,left=500,toolbar=0,status=0")}</script>
<button title="分享到 Mastodon" onclick='shareOnMastodon("Linux/Windows/MacOSX 系统常用命令集锦","https://thiscute.world/posts/common-commands-for-various-operating-systems/")'><span class="fab fa-mastodon fa-fw"></span></button></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/linux/>Linux</a>,&nbsp;<a href=/tags/macosx/>MacOSX</a>,&nbsp;<a href=/tags/windows/>Windows</a>,&nbsp;<a href=/tags/cli/>CLI</a>,&nbsp;<a href=/tags/powershell/>Powershell</a>,&nbsp;<a href=/tags/shell/>Shell</a>,&nbsp;<a href=/tags/tmux/>tmux</a>,&nbsp;<a href=/tags/rsync/>rsync</a>,&nbsp;<a href=/tags/vim/>vim</a>,&nbsp;<a href=/tags/awk/>awk</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/python-tips-and-tricks/ class=prev rel=prev title="Python 实用技巧与常见错误集锦"><i class="fas fa-angle-left fa-fw"></i>Python 实用技巧与常见错误集锦</a>
<a href=/posts/likenttt-2020-12-13-guangzhou-marathon-3_30_15/ class=next rel=next title=「转」MIRT出征广马——首次摸到330的边儿>「转」MIRT出征广马——首次摸到330的边儿<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=utterances></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>Utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><a href=https://www.foreverblog.cn/ target=_blank><img src=https://img.foreverblog.cn/logo_en_default.png alt style=display:inline-block;width:auto;height:20px></a>
<a href=https://www.foreverblog.cn/go.html target=_blank><img src=https://img.foreverblog.cn/wormhole_3.gif alt style=display:inline-block;width:auto;height:20px title=穿梭虫洞-随机访问十年之约友链博客></a></div><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreferrer" title="Hugo 0.110.0">Hugo</a> 强力驱动&nbsp;|&nbsp;托管在 <a title=Vercel href=https://vercel.com/ target=_blank rel="noopener noreffer">Vercel</a> 上&nbsp;|&nbsp;主题 - <a href=https://github.com/HEIGE-PCloud/DoIt target=_blank rel="noopener noreferrer" title="DoIt 0.4.0"><i class="far fa-edit fa-fw"></i> DoIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://thiscute.world/ target=_blank rel="noopener noreferrer">ryan4yin</a></span>&nbsp;|&nbsp;<span class=license> <a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/katex/copy-tex.min.css><noscript><link rel=stylesheet href=/lib/katex/copy-tex.min.css></noscript><script type=text/javascript>window.config={code:{maxShownLines:100},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"",lightTheme:"github-light",repo:"ryan4yin/thiscute.world"}},data:{"desktop-header-typeit":"This Cute World","mobile-header-typeit":"This Cute World"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{algoliaAppID:"747LJ10EI7",algoliaIndex:"ryan-space",algoliaSearchKey:"658db5f2bf056f83458cacf5dd58ec80",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"algolia"},sharerjs:!0,typeit:{cursorChar:null,cursorSpeed:null,data:{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},duration:null,speed:null}}</script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js defer></script><script type=text/javascript src=/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/js/katex.min.js defer></script><script type=text/javascript src=/js/theme.min.js defer></script><script type=text/javascript src=/js/utterances.min.js defer></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-4V93QVSNFW",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-4V93QVSNFW" async></script></div></body></html>