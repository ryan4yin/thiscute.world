# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this
repository.

## Project Overview

This is Ryan4Yin's personal blog, "This Cute World," built with Hugo static site generator
using the DoIt theme. The blog is hosted on Vercel and GitHub Pages.

## Development Commands

### Hugo Commands

```bash
# Create a new post
hugo new posts/2024/Q3/my-first-post/index.md

# Local development with drafts
hugo server --buildDrafts --disableFastRender

# Production mode local server
hugo serve -e production --disableFastRender

# Serve static files (requires caddy)
caddy file-server --root public/ --listen 0.0.0.0:8881
```

### Nix Development Environment

```bash
# On NixOS with direnv, cd into project auto-enters devShell
# Or manually enter:
nix develop

# Process posts (Python script)
python3 process_posts.py
```

### Pre-commit Hooks

The project uses pre-commit hooks configured in flake.nix:

- alejandra (Nix linter)
- typos (spell checker with auto-fix)
- prettier (Markdown & TypeScript formatter)

## Architecture

### Content Structure

- `content/posts/`: Blog posts organized by year/quarter
- `content/about/`: About pages (Chinese and English)
- `content/history/`: Yearly summary pages
- `content/now/`: Current status pages
- `content/friends/`: Friends page

### Theme Configuration

- Uses DoIt theme (`themes/DoIt/`)
- Main configuration in `config.toml`
- Supports Chinese (Simplified) and English languages
- Features: search (Algolia), comments (Utterances/Waline), analytics (Google Analytics)

### Static Assets

- `static/`: Images, avatars, favicons
- `static/_redirects`: Redirect rules for Vercel

### Data Files

- `data/posts_count.json`: Posts statistics generated by Python script
- `data/website_statistics.json`: Google Analytics data
- `data/authors/`: Author information

### Python Processing

`process_posts.py` script handles:

- Post metadata parsing from YAML frontmatter
- Posts counting and statistics
- Content organization

### Deployment

- GitHub Actions workflow (`main.yaml`) handles:
  - Google Analytics data fetching
  - GitHub Pages deployment (gh-pages branch)
  - Algolia search index updates
- Vercel configuration in `vercel.json` (sets Hugo version)

## Key Configuration Details

### Content Organization

Posts follow a specific URL structure: `posts/:contentbasename` (permalinks config)

### Search Setup

Uses Algolia search with configuration in `config.toml`

- Index: "ryan-space"
- Content length: 4000 characters

### Multi-language Support

Primary language: Simplified Chinese (`zh-cn`) Secondary language: English (`en`)

### Features Enabled

- KaTeX math rendering
- Syntax highlighting with line numbers
- Table of contents
- Related posts
- Social sharing
- Comment systems (Utterances primary, Waline backup)
- PWA disabled
